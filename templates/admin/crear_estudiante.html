{% extends "base.html" %}

{% block title %}Crear Nuevo Estudiante{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row">
        <div class="col-12">
            <h1>Crear Nuevo Estudiante</h1>
        </div>
    </div>

    <form id="estudianteForm" method="POST" action="{{ url_for('admin.crear_estudiante') }}" enctype="multipart/form-data">
        <hr>
        <h4>Datos Personales</h4>
        <div class="row">
            <div class="col-md-3 mb-2">
                <label for="ci" class="form-label">CI</label>
                <input type="number" class="form-control form-control-sm" id="ci" name="ci" required>
            </div>
            <div class="col-md-3 mb-2">
                <label for="expedicion" class="form-label">Expedición</label>
                <input type="text" class="form-control form-control-sm" id="expedicion" name="expedicion">
            </div>
            <div class="col-md-6 mb-2">
                <label for="nombre" class="form-label">Nombre</label>
                <input type="text" class="form-control form-control-sm" id="nombre" name="nombre" required onkeypress="return soloLetras(event)">
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-6 mb-2">
                <label for="paterno" class="form-label">Apellido Paterno</label>
                <input type="text" class="form-control form-control-sm" id="paterno" name="paterno" required onkeypress="return soloLetras(event)">
            </div>
            <div class="col-md-6 mb-2">
                <label for="materno" class="form-label">Apellido Materno</label>
                <input type="text" class="form-control form-control-sm" id="materno" name="materno" onkeypress="return soloLetras(event)">
            </div>
        </div>

        <div class="row">
            <div class="col-md-3 mb-2">
                <label for="fecha_nac" class="form-label">Fecha de Nacimiento</label>
                <input type="date" class="form-control form-control-sm" id="fecha_nac" name="fecha_nac">
            </div>
            <div class="col-md-3 mb-2">
                <label for="genero" class="form-label">Género</label>
                <select class="form-select form-select-sm" id="genero" name="genero" required>
                    <option value="">Seleccionar...</option>
                    <option value="MASCULINO">Masculino</option>
                    <option value="FEMENINO">Femenino</option>
                </select>
            </div>
        </div>

        <div class="row">
            <div class="col-12 mb-2">
                <label for="direccion" class="form-label">Dirección</label>
                <input type="text" class="form-control form-control-sm" id="direccion" name="direccion">
            </div>
        </div>

        <div class="row">
            <div class="col-md-6 mb-2">
                <label for="nombre_padre" class="form-label">Nombre del Padre</label>
                <input type="text" class="form-control form-control-sm" id="nombre_padre" name="nombre_padre" onkeypress="return soloLetras(event)">
            </div>
            <div class="col-md-3 mb-2">
                <label for="telefono_padre" class="form-label">Teléfono del Padre</label>
                <input type="tel" class="form-control form-control-sm" id="telefono_padre" name="telefono_padre">
            </div>
        </div>

        <div class="row">
            <div class="col-md-6 mb-2">
                <label for="nombre_madre" class="form-label">Nombre de la Madre</label>
                <input type="text" class="form-control form-control-sm" id="nombre_madre" name="nombre_madre" onkeypress="return soloLetras(event)">
            </div>
            <div class="col-md-3 mb-2">
                <label for="telefono_madre" class="form-label">Teléfono de la Madre</label>
                <input type="tel" class="form-control form-control-sm" id="telefono_madre" name="telefono_madre">
            </div>
        </div>

        <div class="row mt-4">
            <div class="col-md-4">
                <h4>Foto de Perfil</h4>
                <div class="mb-3 text-center">
                   
                    <img id="vista-previa" src="https://via.placeholder.com/200" alt="Vista previa" class="img-fluid rounded mb-3" style="max-height: 200px;">
                    
                    <label for="foto_estudiante" class="form-label">Seleccionar Foto</label>
                    <input type="file" class="form-control" id="foto_estudiante" name="foto_estudiante" accept="image/png, image/jpeg, image/jpg" onchange="mostrarVistaPrevia(event);">
                </div>
            </div>
        </div>

        <hr>
        <h4>Datos de Acceso al Sistema</h4>
        <div class="row">
            <div class="col-md-6 mb-2">
                <label for="username" class="form-label">Usuario</label>
                <input type="text" class="form-control form-control-sm" id="username" name="username" required>
            </div>
            <div class="col-md-6 mb-2">
                <label for="password" class="form-label">Contraseña</label>
                <input type="password" class="form-control form-control-sm" name="password" required>
            </div>
        </div>

        <div class="row mt-4">
            <div class="col-12">
                <button type="submit" class="btn btn-success btn-sm">Crear Estudiante</button>
                <a href="{{ url_for('admin.listar_estudiantes') }}" class="btn btn-secondary btn-sm">Cancelar</a>
            </div>
        </div>
    </form>
</div>

<script>
    function mostrarVistaPrevia(event) {
        const archivo = event.target.files[0];
        const vistaPrevia = document.getElementById('vista-previa');

        if (archivo) {
            const lector = new FileReader();

            lector.onload = function(e) {
                vistaPrevia.src = e.target.result;
            }

            lector.readAsDataURL(archivo);
        } else {
            vistaPrevia.src = "https://via.placeholder.com/200";
        }
    }
</script>
{% endblock %}